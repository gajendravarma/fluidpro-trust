{% extends 'base.html' %}

{% block title %}Create Automation Task - Pulseway{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow">
                <div class="card-header">
                    <h4 class="mb-0">
                        <i class="fas fa-robot text-primary"></i> Create Automation Task
                    </h4>
                </div>
                <div class="card-body">
                    <form method="post">
                        {% csrf_token %}
                        
                        <div class="row">
                            <div class="col-md-8">
                                <div class="mb-3">
                                    <label for="{{ form.name.id_for_label }}" class="form-label">
                                        <i class="fas fa-tag"></i> Task Name *
                                    </label>
                                    {{ form.name }}
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">
                                        <i class="fas fa-toggle-on"></i> Status
                                    </label>
                                    <div class="form-check form-switch">
                                        {{ form.enabled }}
                                        <label class="form-check-label" for="{{ form.enabled.id_for_label }}">
                                            Enable Task
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="{{ form.description.id_for_label }}" class="form-label">
                                <i class="fas fa-align-left"></i> Description
                            </label>
                            {{ form.description }}
                        </div>

                        <div class="mb-3">
                            <label for="{{ form.schedule.id_for_label }}" class="form-label">
                                <i class="fas fa-clock"></i> Schedule (Cron Expression) *
                            </label>
                            {{ form.schedule }}
                            <div class="form-text">
                                {{ form.schedule.help_text }}
                                <br>
                                <strong>Examples:</strong>
                                <ul class="mb-0 mt-1">
                                    <li><code>0 2 * * *</code> - Daily at 2:00 AM</li>
                                    <li><code>0 0 * * 0</code> - Weekly on Sunday at midnight</li>
                                    <li><code>0 9 1 * *</code> - Monthly on 1st at 9:00 AM</li>
                                </ul>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="{{ form.target_devices.id_for_label }}" class="form-label">
                                <i class="fas fa-desktop"></i> Target Devices *
                            </label>
                            {{ form.target_devices }}
                            <div class="form-text">{{ form.target_devices.help_text }}</div>
                        </div>

                        <div class="mb-3">
                            <label for="{{ form.script_content.id_for_label }}" class="form-label">
                                <i class="fas fa-code"></i> Script Content *
                            </label>
                            {{ form.script_content }}
                            <div class="form-text">Enter the script or commands to execute on target devices</div>
                        </div>

                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <a href="{% url 'pulseway:automation_tasks' %}" class="btn btn-secondary">
                                <i class="fas fa-times"></i> Cancel
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Create Task
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Help Card -->
            <div class="card shadow mt-4">
                <div class="card-header">
                    <h6 class="mb-0">
                        <i class="fas fa-question-circle text-info"></i> Automation Task Help
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Cron Schedule Format</h6>
                            <p class="small text-muted">
                                Cron expressions consist of 5 fields:<br>
                                <code>minute hour day month weekday</code>
                            </p>
                            <ul class="small">
                                <li><strong>minute:</strong> 0-59</li>
                                <li><strong>hour:</strong> 0-23</li>
                                <li><strong>day:</strong> 1-31</li>
                                <li><strong>month:</strong> 1-12</li>
                                <li><strong>weekday:</strong> 0-7 (0 or 7 = Sunday)</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>Special Characters</h6>
                            <ul class="small">
                                <li><code>*</code> - Any value</li>
                                <li><code>,</code> - Value list separator</li>
                                <li><code>-</code> - Range of values</li>
                                <li><code>/</code> - Step values</li>
                            </ul>
                            <h6 class="mt-3">Common Examples</h6>
                            <ul class="small">
                                <li><code>0 */6 * * *</code> - Every 6 hours</li>
                                <li><code>30 1 * * 1-5</code> - 1:30 AM, weekdays</li>
                                <li><code>0 0 1,15 * *</code> - 1st and 15th of month</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
